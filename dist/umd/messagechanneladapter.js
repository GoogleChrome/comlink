'use strict';(function(k,f){"object"===typeof exports&&"undefined"!==typeof module?f(exports):"function"===typeof define&&define.amd?define(["exports"],f):f(k.Comlink={})})(this,function(k){function f(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function r(a,d){return d.reduce(function(c,b){return c[b]},a)}function l(a){void 0===a&&(a=128);return Array(a/16).fill(0).map(f).join("")}function m(a,d,c){a=r(a,d.slice(0,-1));d=d[d.length-1];var b=a[d];a[d]=c;return b}function n(a,
d,c){var b=c||{};c=b.path;c=void 0===c?[]:c;b=b.channels;b=void 0===b?[]:b;if(a instanceof d)b.push(c.slice());else if(a instanceof Object)for(var e=0,g=Object.keys(a);e<g.length;e++){var h=g[e];n(a[h],d,{path:c.concat([h]),channels:b})}return b}function p(a,d){void 0===d&&(d=null);var c=new MessageChannel,b=c.port1;q(c.port2,a,d);return b}function q(a,d,c){void 0===c&&(c=null);a.onmessage=function(b){c||(c=l());var a=b.data;b=n(b.data,MessagePort);for(var g=0;g<b.length;g++){var h=b[g],f=l();h=m(a,
h,f);q(h,d,f)}a=JSON.stringify({id:c,msg:a,messageChannels:b});d.send(a)};d.addEventListener("message",function(b){var e={};try{e=JSON.parse(b.data)}catch(g){return}c&&c!==e.id||(b=e.messageChannels.map(function(b){var a=b.reduce(function(a,b){return a[b]},e.msg);a=p(d,a);m(e.msg,b,a);return a}),a.postMessage(e.msg,b))})}k.wrap=p;Object.defineProperty(k,"__esModule",{value:!0})});
